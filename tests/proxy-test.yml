config:
  target: "http://localhost:3000"
  http:
    timeout: 10
  phases:
    - duration: 60
      arrivalRate: 50
      rampTo: 100
    - duration: 60
      arrivalRate: 100
      rampTo: 200
    - duration: 60
      arrivalRate: 75
      rampTo: 100
    - duration: 300
      arrivalRate: 100
      rampTo: 200
  processor: "./processor.js"

scenarios:
  - name: "View product page"
    weight: 15
    flow:
      - function: "generateProductId"
      - get:
          url: "/{{ productId }}/"
  - name: "View multiple product pages"
    weight: 15
    flow:
      - function: "generateProductId"
      - loop:
        - get:
            url: "/{{ productId }}/"
        count: 5
        think: 3
  - name: "View product page and leave review"
    weight: 1
    flow:
      - function: "generateProductId"
      - get:
          url: "/{{ productId }}/"
      - think: 5
      - post:
          url: "/review"
          headers:
            Content-Type: "application/json"
          beforeRequest: "generateProductReview"
